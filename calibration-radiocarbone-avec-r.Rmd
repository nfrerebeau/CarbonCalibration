---
title: |
  Calibrer des âges radiocarbones avec R
authors:
- Nicolas Frerebeau
- Brice Lebrun
date: 2020-08-20
reviewers:
layout: lesson
output:
  rmarkdown::html_document:
    keep_md: false
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  fig.path = "figures/",
  fig.align = "center"
)
```

Cette leçon explique comment calibrer des âges radiocarbones avec le langage R. La méthode du radiocarbone est une méthode de datation dite *absolue*[^1] qui possède son propre référentiel temporel. La calibration est une étape indispensable, permettant le passage du référentiel radiocarbone à un référentiel calendaire. Cette leçon se limite aux cas simples de calibration, elle ne couvre pas les cas avancés (calibration marine, problèmes de réservoirs, etc.) ni les problèmes de modélisation bayésienne. L'objectif de la leçon est d'apprendre à calibrer des âges individuels, à combiner plusieurs âges en un seul et à tester des différences entre âges.

L'utilisation de R permet de mettre en place des routines de traitement des données et de garantir la reproductibilité des résultats au moment de leur publication. Cette leçon nécessite comme prérequis d'être à l'aise avec un usage basique de R.

## Pourquoi calibrer des âges radiocarbones ?

Proposée à la fin des années 1940 par Willard Libby et ses collègues[^2], la méthode du radiocarbone utilise la décroissance radioactive du carbone 14 (^14^C) pour construire un chronomètre. Ce dernier permet d'estimer des âges, c'est-à-dire des intervalles de temps mesurés depuis le présent[^8]. Par convention, les âges radiocarbones sont ainsi exprimés en (kilo) années BP (*Before Present*, avant 1950)[^6].

L'élaboration d'un chronomètre suppose de vérifier trois conditions nécessaires :

- Le phénomène choisi doit suivre une loi qui varie au cours du temps ;
- La loi en question doit être indépendante des conditions du milieu ;
- Un événement initial doit pouvoir être déterminé.

Le carbone 14 est un est des trois isotope du carbone avec le carbone 12 et le carbone 13. Le ^14^C est un isotope radioactif : il tend à se désintégrer au cours du temps selon une loi exponentielle décroissante. Il s'agit d'un phénomène nucléaire, indépendant du milieu. Pour un isotope donné, ce phénomène de décroissance radioactive peut être décrit à l'aide une grandeur particulière, la *période radioactive* (notée $T$, également appelée *demi-vie*). Cette dernière correspond au temps nécessaire à la désintégration de la moitié d'une quantité intiale d'atomes.

La période du ^14^C est de 5730 ± 40 ans : pour une quantité initiale $N_0$ d'atomes de ^14^C, il en reste $\frac{N_0}{2}$ au bout de 5730 ans, $\frac{N_0}{4}$ au bout de 11460 ans, etc. (fig. 1). Au bout de 8 à 10 périodes (environ 45000 à 55000 ans), on considère que la quantité de ^14^C est trop faible pour être mesurée : c'est la limite de la méthode.

```{r decroissance, echo=FALSE, fig.width=7, fig.height=3.5, fig.cap="Figure 1 : Décroissance exponentielle d'une quantité $N_0$ d'atomes radioactifs au cours du temps (exprimé en périodes radioactives)."}
i <- 5730
par(mar = c(4, 4, 1, 1) + 0.1, las = 1)
curve(
  expr = 1 * exp(-(log(2) / i) * x),
  from = 0, to = 10 * 5730,
  xlab = "Temps (périodes)", ylab = "Nombre d'atomes",
  xaxs = "i", yaxs = "r",
  xaxt = "n", yaxt = "n"
)
axis(side = "1", at = 1:10 * 5730, labels = paste0(1:10, "T"))
axis(side = "2", at = c(0.25, 0.50, 1), 
     labels = expression(frac("N"[0], 4), frac("N"[0], 2), "N"[0]))
# axis(side = "4", at = c(0.25, 0.50, 1), labels = c("A/4", "A/2", "A"))
# mtext("Activité", side = 4, line = 3, las = 0)
lines(x = c(0, 1, 1) * i, y = c(0.50, 0.50, -1), type = "l", lty = 2, col = "red")
lines(x = c(0, 2, 2) * i, y = c(0.25, 0.25, -1), type = "l", lty = 2, col = "red")
```

Le carbone 14 est produit naturellement en haute atmosphère sous l'effet des rayonnements cosmiques. Il est ensuite progressivement absorbé par les organismes vivants au fil de la chaîne trophique (en commençant par les organismes photosynthétiques). On considère alors que la teneur en ^14^C dans les organismes vivants est constante et à l'équilibre avec la teneur atmospherique[^10].

Lorsqu'un organisme meurt, les échanges avec le milieu s'arrêtent. En supposant qu'il n'y a pas de contamination extérieure, on considère que le système est clos : la décroissance radioactive est le seul phénomène affectant la quantité de carbone 14 contenue dans l'organisme. L'événement daté par le radiocarbone est ainsi la mort de l'organisme.

Sauf à rechercher spécifiquement à quand remonte la mort d'un organisme, le radiocarbone fournis donc un *teminus post-quem* pour l'événement archéologique que l'on souhaite positionner dans le temps. C'est-à-dire le moment après lequel a eu lieu l'événement archéologique ou historique d'intérêt (abandon d'un objet, combustion d'un foyer, dépôt d'une couche sédimentaire, etc.).

Grâce à la loi de décroissance radioactive, si on connait la quantité initiale ($N_0$) de ^14^C contenue dans un organisme à sa mort ($t_0$) et la quantité restante de ^14^C à un instant $t$, il est possible de mesurer le temps écoulé entre $t_0$ et $t$ : l'âge radiocarbone d'un objet archéologique. 

* La quantité actuelle de ^14^C dans un objet peut être déterminée en laboratoire, soit en comptant les noyaux de ^14^C, soit en comptant le nombre de désintégration par unité de temps et par quantité de matière (*activité spécifique*). 
* Pour déterminer la quantité initiale, la méthode du radiocarbone repose sur l'hypothèse suivante : la quantité de ^14^C dans l'atmosphère est constante dans le temps et égale à la teneur actuelle.

Ce postulat de départ a permis à Libby et ses collègues de démontrer la faisabilité de la méthode en réalisant les premières datations radiocarbones sur des objets d'âge connus par ailleurs[^3]. Au regard des résultats alors obtenus, il apparaît qu'il existe une relation linéaire entre les âges radiocarbones mesurés et les âges calendaires connus par d'autres méthodes (fig. 2A).

Les études menées dans la seconde moitié du XX^e^ siècle, à mesure que des objets de plus en plus anciens étaient datés, ont néanmoins permis d'établir que la teneur en ^14^C dans l'atmosphère n'est pas constante au cours du temps. Cette dernière varie en fonction de phénomènes naturels (variations du champ magnétique terrestre, activité solaire, activité volcanique, cycle du carbone...) et anthropiques. Ces phénomènes peuvent être contradictoires : l'usage des combustibles fossiles libere du carbone très ancien et tend à diminuer la teneur relative de ^14^C (effet Suess), à l'inverse les essais nucléaires atmosphériques ont produit de grandes quantités de ^14^C. 

Le chronomètre que constitue la méthode du radiocarbone n'a donc pas un rythme régulier (car la teneur atmosphérique en ^14^C varie au cours du temps). En conséquence, les âges radiocarbones (également dits *âges conventionnels*) appartiennent à un référentiel temporel qui leur est propre.

L'utilisation du postulat de Libby demeure néanmoins la seule façon accessible pour estimer la quantité initiale de ^14^C à la fermeture du système. Il est donc nécessaire de réaliser une opération dite de *calibration* pour transformer un âge conventionnel en âge calendaire. Cette opération est réalisée à l'aide d'une courbe[^4], régulièrement mise à jour par la communauté scientifique[^5]. La courbe de calibration est construite en datant des échantillons à la fois par le radiocarbone et par une méthode indépendante, offrant ainsi une table d'équivalence entre temps radiocarbone et temps calendaire (fig. 2B).

```{r intcal, echo=FALSE, fig.width=7, fig.height=3.5, fig.cap="Figure 2 : Âges mesurées par le radiocarbone en fonction des âges calendaires attendus. (A) *Curve of Knowns*, âges radiocarbones d'objets archéologiques dont l'âge calendaire est connu par des méthodes indépendantes (d'après Arnold et Libby, 1949). La droite 1:1, pour laquelle un âge conventionnel est égal à un âge calendaire, est représentée en tirets. (B) Courbes de calibration IntCal09, IntCal13 et IntCal20 (Reimer *et al.* 2009, 2013 et 2020). L'écart à la droite 1:1 (tirets) est d'autant plus marqué que les âges sont anciens."}
arnold <- read.table("data/arnold1949.csv", sep = ";", dec = ".",
                    header = TRUE)
arnold$age_expected <- arnold$age_expected / 1000
arnold$age_expected_error <- arnold$age_expected_error / 1000
arnold$age_found <- arnold$age_found / 1000
arnold$age_found_error <- arnold$age_found_error / 1000

intcal09 <- read.table("data/intcal09.14c", sep = ",", dec = ".",
                       header = FALSE, skip = 11)
intcal13 <- read.table("data/intcal13.14c", sep = ",", dec = ".",
                       header = FALSE, skip = 11)
intcal20 <- read.table("data/intcal20.14c", sep = ",", dec = ".",
                       header = FALSE, skip = 11)
par(mfrow = c(1, 2), mar = c(4, 4, 1, 1) + 0.1, las = 1)
plot(
  x = arnold$age_expected[-1],
  y = arnold$age_found[-1],
  type = "p", pch = 16, col = "black",
  xlim = c(5, 1), ylim = c(1, 5),
  xlab = "Âge calendaire (ka BP)",
  ylab = "Âge conventionnel (ka BP)",
  asp = 1
)
# fit <- lm(age_found ~ age_expected, data = arnold)
# abline(fit, lty = 2, col = "red")
segments(x0 = arnold$age_expected,
         y0 = arnold$age_found - arnold$age_found_error,
         x1 = arnold$age_expected,
         y1 = arnold$age_found + arnold$age_found_error)
segments(x0 = arnold$age_expected - arnold$age_expected_error,
         y0 = arnold$age_found,
         x1 = arnold$age_expected - arnold$age_expected_error,
         y1 = arnold$age_found)
abline(a = 0, b = 1, col = "red", lty = 2)
mtext("A", side = 2, line = 3, at = 5, font = 2)
plot(
  x = intcal09[, 1] / 1000,
  y = intcal09[, 2] / 1000,
  type = "l", lty = 1, col = "#DDAA33",
  xlab = "Âge calendaire (ka BP)",
  ylab = "Âge conventionnel (ka BP)",
  xlim = rev(range(intcal20[, 1] / 1000)),
  asp = 1
)
lines(
  x = intcal13[, 1] / 1000,
  y = intcal13[, 2] / 1000,
  type = "l", lty = 1, col = "#BB5566",
)
lines(
  x = intcal20[, 1] / 1000,
  y = intcal20[, 2] / 1000,
  type = "l", lty = 1, col = "#004488",
)
abline(a = 0, b = 1, lty = 2, col = "black")
mtext("B", side = 2, line = 3, at = 51, font = 2)
legend("topright", legend = c("IntCal09", "IntCal13", "IntCal20"),
       col = c("#DDAA33", "#BB5566", "#004488"), lty = 1)
```

## Comment calibrer ?

Un âge conventionnel (noté ici $t$) est le résultat d'une mesure et, comme il n'existe pas de mesure parfaite, il est toujours accompagné d'un terme correspondant à l'erreur analytique ($\Delta t$) et exprimé sous la forme $t \pm \Delta t$ (l'âge plus ou moins son incertitude). Cette incertitude résulte de la combinaison des différents sources d'erreur au sein du laboratoire : il ne s'agit pas d'un accident au sein du laboratoire, mais d'une incertitude *aléatoire* inhérente à la mesure.

Un âge conventionel est ainsi un *estimateur* du vrai âge radiocarbone de l'objet daté. Si on répette un très grand nombre de fois la datation d'un même échantillon, sa valeur est susceptible de varier et il y a très peu de chance qu'elle coincide exactement avec l'âge radiocarbone vrai.

Il est donc préférable de s'attacher à un intervalle dont il est hautement probable qu'il contienne la vrai valeur (inconnue) de âge conventionnel. De fait, l'incertitude caractérise la dispersion des valeurs qui pourraient raisonnablement être attribuées à l'âge vrai. Un âge conventionnel est la réalisation d'un processus aléatoire, la décroissance radioactive, il peut être ainsi modélisé à l'aide d'une loi de probabilité particulière, la loi normale[^7], et une mesure de la dispersion des valeurs que peut prendre cet âge est donné par l'écart-type.

Seuls deux paramètres sont nécessaires pour caractériser la distribution des valeurs selon une loi normale : la moyenne $\mu$ (tendance centrale) et l'écart-type $\sigma$ (dispersion des valeurs). Les propriétés de la distribution normale sont telles que l'intervalle défini par $\mu \pm \sigma$ contient 67 % des valeurs. Si on multiplie l'écart-type par deux, l'intervalle $\mu \pm 2\sigma$ contient quant à lui 95 % des valeurs (fig. 3).

Ainsi, si on exprime l'incertitude d'un âge conventionnel en fonction de l'écart-type, il y a 68 % de chance que l'intervalle à $1\sigma$ contienne l'âge conventionnel vrai. De même, l'intervalle à $2\sigma$ a 95 % de chance de contenir l'âge conventionnel vrai. L'intervalle à $1\sigma$ est plus précis (moins dispersé), mais moins juste qu'à $2\sigma$ : la plage de valeurs retenues est plus resserée, mais elle a moins de chance de contenir l'âge conventionnel vrai.

```{r gauss, echo=FALSE, fig.width=7, fig.height=2.5, fig.cap="Figure 3 : Loi normale de moyenne 0 et d'écart-type 1 avec les plage de normalité aux niveaux de confiance 68, 95 et 99 %. La distribution des valeurs est telle que la dispersion est symétrique autour de la tendance centrale."}
x <- seq(-50, 50, by = 0.1)
y <- dnorm(x, mean = 0, sd = 1)

p <- function() {
  plot(x = NULL, y = NULL, type = "n", xlim = c(-4, 4), ylim = c(0, 0.4),
       xlab = "", ylab = "", xaxt = "n", yaxt = "n")
  axis(side = 1, at = -3:3,
       labels = expression("-"*3*sigma, "-"*2*sigma, "-"*sigma, 0, 
                           sigma, 2*sigma, 3*sigma))
}
f <- function(x, y, start, stop, fill) {
  s <- which(x >= start & x <= stop)
  polygon(
    x = c(x[s], rev(x[s])),
    y = c(y[s], rep(0, length(s))),
    col = fill, border = NA
  )
}

par(mfrow = c(1, 3), mar = c(2, 1, 1, 1) + 0.1, las = 1)
p()
f(x, y, -1, 1, "#DDAA33")
lines(x = x, y = y, type = "l", lty = 1, lwd = 1.5)
text(x = 0, y = 0.2, labels = "68.3 %", col = "white", cex = 1.2, font = 2)
p()
f(x, y, -2, 2, "#BB5566")
lines(x = x, y = y, type = "l", lty = 1, lwd = 1.5)
text(x = 0, y = 0.2, labels = "95.4 %", col = "white", cex = 1.2, font = 2)
p()
f(x, y, -3, 3, "#004488")
lines(x = x, y = y, type = "l", lty = 1, lwd = 1.5)
text(x = 0, y = 0.2, labels = "99.7 %", col = "white", cex = 1.2, font = 2)
```

L'approche la plus élémentaire pour la calibration d'un âge radiocarbone consiste à intercepter la courbe de calibration entre les bornes d'incertitude ($t - \Delta t$ et $t + \Delta t$ dans le cas à $1\sigma$) pour obtenir l'intervalle d'âges calendaires correspondants (fig. 4). Cette approche ne tient cependant pas compte du fait qu'un âge radiocarbone est décrit par une distribution normale. Dans la plage définie par l'âge radiocarbone plus ou moins son incertitude, toutes les valeurs n'ont la même probabilité de coincider avec l'âge radiocarbone vrai, or la calibration par simple interception suppose l'inverse. De fait, l'approche aujourd'hui courante[^9] consiste à prendre également en compte la distribution normale des âges radiocarbones (on trouve parfois l'expression de *calibration probabiliste* pour la désigner). Cette méthode de calibration recourt à méthodes numériques et la distribution des âges calendaires qui en résulte n'est pas équiprobable (fig. 5).

```{r calibration, echo=FALSE, fig.width=6, fig.height=6, fig.cap="Figure 4 : Calibration d'un âge conventionnel de 2725 ± 50 ans BP par interception de la courbe de calibration IntCal20 (trait plein). L'épaisseur du bandeau gris représente l'incertitude associé à la courbe de calibration."}
# bronze <- rcarbon::calibrate(2725, 50, calMatrix = TRUE, verbose = FALSE)
par(mar = c(4, 4, 1, 1) + 0.1, las = 1)
plot(
  x = NULL, y = NULL,
  type = "n",
  xlab = "Âge calendaire (années BC)",
  ylab = "Âge conventionnel (années BP)",
  xlim = c(1100, 750),
  ylim = c(2550, 2900),
  asp = 1, xaxs = "i", yaxs = "i"
)
polygon(
  x = c(intcal20[, 1], rev(intcal20[, 1])) - 1950,
  y = c(intcal20[, 2] - intcal20[, 3], rev(intcal20[, 2] + intcal20[, 3])),
  col = "grey", border = NA, lty = 3
)
lines(
  x = (intcal20[, 1] - 1950),
  y = intcal20[, 2],
  type = "l", lty = 1, col = "black", lwd = 1.5
)
x <- c(915, 812, 986, 802)
segments(
  x0 = rep(2000, 4), x1 = x,
  y0 = c(50, -50, 100, -100) + 2725, 
  y1 = c(50, -50, 100, -100) + 2725, 
  lty = c(2, 2, 2, 2)
)
segments(
  x0 = x, x1 = x,
  y0 = c(50, -50, 100, -100) + 2725, 
  y1 = rep(0, 4), 
  lty = c(2, 2, 2, 2)
)
shape::Arrowhead(
  x0 = 1100 - (1100 - x) / 2,
  y0 = c(50, -50, 100, -100) + 2725,
  arr.length = 0.2,
  arr.adj = 1, arr.type	= "triangle"
)
rect(
  xleft = c(1100, x[[4L]]), ybottom = c(2725 - 100, 2550),
  xright = c(1090, x[[3L]]), ytop = c(2725 + 100, 2560),
  col = "black", border = "black", density = 10, angle = 45
)
rect(
  xleft = c(1100, x[[2L]]), ybottom = c(2725 - 50, 2550),
  xright = c(1090, x[[1L]]), ytop = c(2725 + 50, 2560),
  col = "black", border = "black"
)
legend("topright", legend = expression(1*sigma, 2*sigma),
       density = c(NA, 10), fill = c(NULL, "black"))
```

S'il est aisé de décrire un âge conventionnel et son incertitude avec une loi normale, il va en tout autrement d'un âge calendaire une fois calibré. Il n'est en effet pas possibile de decrire la distribution d'un âge calendaire avec une loi de probabilité particulière. Ceci est dû à la nature de la courbe de calibration qui n'est pas linéaire, mais présente une allure en dents de scie. Si la valeur et l'incertitude d'un âge radiocarbone suffisent à le décrire, un âge calendaire ne peut être exprimé que sous la forme d'un intervalle. Retenir la seule valeur centrale ou la valeur la plus probable d'un âge calibré n'a pas de sens statistique.

L'intervalle auquel appartient un âge calendaire résulte à la fois de l'incertitude de l'âge conventionnel, de l'allure de la courbe de calibration et de l'incertitude associée à cette dernière. Il existe ainsi des périodes qui sont plus ou moins propices à des datations radiocarbones, en fonction de l'allure de la courbe. Le cas le moins favorable est l'existence de plateaux au sein de la courbe de calibration, dont un cas typique est le plateau de l'Âge du Fer (fig. 5).

Par exemple, un âge conventionnel de 2450 ± 75 ans BP correspond, une fois calibré à $2\sigma$, à un âge calendaire compris entre 2719 et 2353 ans BP (soit 769-403 avant notre ère). Ainsi, malgré un âge conventionnel avec une incertitude assez faible (3 %), l'âge calendaire correspondant a 95 % de chance de se trouver dans un intervalle de temps qui couvre la quasi-totalité du premier Âge du Fer (fig. 5). On pourrait alors être tenté de réaliser la calibration avec une incertitude à $1\sigma$ pour resserrer l'intervalle. Dans ce cas, le résultat n'est guère meilleur et on se retrouve confronté à une autre difficulté, liée aux oscillations de la courbe de calibration : l'âge calendaire a 68 % de chance d'appartenir à l'union des intervalles 748-684 (18 %), 665-637 (8 %), 586-580 (2 %), 568-452 (32 %) et 444-415 (8 %) avant notre ère et non à un unique intervalle (fig. 5).

```{r hallstatt, echo=FALSE, fig.width=6, fig.height=6, fig.cap="Figure 5 : Plateau de l'Âge du Fer. En haut à droite : extrait de la courbe IntCal20 (trait plein). L'épaisseur du bandeau gris représente l'incertitude associée à la courbe de calibration. En haut à gauche : distribution d'un âge radiocarbone de 2450 ± 75 ans BP. En bas à droite : distribution de l'âge radiocarbone calibré (âge calendaire)."}
layout_matrix <- matrix(c(2, 4, 1, 3), nrow = 2, ncol = 2)
layout(layout_matrix, widths = c(1, 2), heights = c(2, 1))
## InCal20
par(mar = c(4, 4, 1, 1) + 0.1, las = 1)
plot(
  x = NULL, y = NULL,
  type = "n",
  xlab = "Âge calendaire (années BC)",
  ylab = "",
  xlim = c(900, 200),
  ylim = c(2150, 2850),
  asp = 1
)
mtext("Âge conventionnel (années BP)", side = 2, line = 3.5, las = 0, cex = 0.8)
polygon(
  x = c(intcal20[, 1], rev(intcal20[, 1])) - 1950,
  y = c(intcal20[, 2] - intcal20[, 3], rev(intcal20[, 2] + intcal20[, 3])),
  col = "grey", border = NA, lty = 3
)
lines(
  x = (intcal20[, 1] - 1950),
  y = intcal20[, 2],
  type = "l", lty = 1, col = "black", lwd = 1.5
)
## Âge conventionnel
x <- seq(0, 50000, by = 1)
y <- dnorm(x, mean = 2450, sd = 75)
plot(
  x = NULL,
  y = NULL,
  type = "n",
  ylim = c(2150, 2850),
  xlim = c(0, 0.006),
  ylab = "Âge conventionnel (années BP)",
  xlab = "Probabilité",
)
s2 <- which(x >= 2450 - 2 * 75 & x <= 2450 + 2 * 75)
polygon(
  y = c(x[s2], rev(x[s2])),
  x = c(y[s2], rep(0, length(y[s2]))),
  col = "#BB5566", border = NA, lty = 3
)
s1 <- which(x >= 2450 - 75 & x <= 2450 + 75)
polygon(
  y = c(x[s1], rev(x[s1])),
  x = c(y[s1], rep(0, length(y[s1]))),
  col = "#DDAA33", border = NA, lty = 3
)
lines(
  x = y, 
  y = x,
  type = "l", lty = 1, lwd = 1.5, col = "black"
)
## Âge calendaire
iron <- rcarbon::calibrate(2450, 75, calMatrix = TRUE, verbose = FALSE)
x_cal <- as.numeric(rownames(iron$calmatrix)) - 1950
y_cal <- iron$calmatrix[, 1]
plot(
  x = x_cal, 
  y = y_cal,
  type = "l",
  xlab = "Âge calendaire (années BC)",
  ylab = "",
  xlim = c(900, 200)
)
mtext("Probabilité", side = 2, line = 3.5, las = 0, cex = 0.8)
s2 <- which(x_cal >= 2353 - 1950 & x_cal <= 2719 - 1950)
polygon(
  x = c(x_cal[s2], rev(x_cal[s2])),
  y = c(y_cal[s2], rep(0, length(y_cal[s2]))),
  col = "#BB5566", border = NA, lty = 3
)
s1 <- list(
  a = which(x_cal <= 2698 - 1950 & x_cal >= 2634 - 1950),
  b = which(x_cal <= 2615 - 1950 & x_cal >= 2587 - 1950),
  c = which(x_cal <= 2536 - 1950 & x_cal >= 2530 - 1950),
  d = which(x_cal <= 2518 - 1950 & x_cal >= 2402 - 1950),
  e = which(x_cal <= 2394 - 1950 & x_cal >= 2365 - 1950)
)
# round(unlist(lapply(X = s1, FUN = function(s, y) sum(y[s]), y = y_cal)) * 100)
invisible(
  lapply(
    X = s1,
    FUN = function(s, x, y) {
      polygon(
        x = c(x[s], rev(x[s])),
        y = c(y[s], rep(0, length(y[s]))),
        col = "#DDAA33", border = NA, lty = 3
      )
    },
    x = x_cal, y = y_cal
  )
)
lines(
  x = x_cal, 
  y = y_cal,
  type = "l", lty = 1, lwd = 1.5, col = "black"
)

plot(x = NULL, y = NULL, type = "n", xlim = c(0, 1), ylim = c(0, 1),
     xlab = "", ylab = "", axes = FALSE)
legend("center", legend = expression(1*sigma, 2*sigma), 
       fill = c("#DDAA33", "#BB5566"), bty = "n")
```

## Applications avec R

La datation du Suaire de Turin, réalisée à la fin des années 1980, constitue un cas d'école en matère de datation d'un objet historique par la méthode du radiocarbone : trois datations indépendantes d'un même prélèvement sont réalisées en aveugle, avec des échantillons de contrôle.

En avril 1988, un échantillon de tissu est prélevé sur le Suaire de Turin. Trois laboratoires différents ont été sélectionnés l'année précédente et reçoivent chacun un fragment de ce même échantillon. En complément, trois autres tissus dont les âges calendaires sont connus par d'autres méthodes sont également échantillonés. Ces trois échantillons supplémentaires doivent servir d'échantillons de contrôle, afin de valider les résultats de chaque laboratoire et de s'assurer que les résultats des différents laboratoires sont bien comparables entre eux. Chaque laboratoire a reçu quatre échantillons et réalisé les mesures en aveugle, sans savoir lequel correspond au Suaire (Damon *et al.*, 1989). Les résultats obtenus sont reproduit dans le tableau 1.

* Échantillon 1 : Suaire de Turin.
* Échantillon 2 : fragment de lin provenant d'une tombe de Qasr Ibrîm (Nubie, Égypte), daté des XI^e^-XII^e^ siècles de notre ère.
* Échantillon 3 : fragment de lin associé à une momie de Thèbes (British Museum, EA6707), daté entre -110 et 75.
* Échantillon 4 : fils de la chape de St Louis d'Anjou (Basilique Sainte-Marie-Madeleine de Saint-Maximin-la-Sainte-Baume, France), daté entre 1290 et 1310.

| Laboratoire | Éch. 1   | Éch. 2   | Éch. 3    | Éch. 4   |
|:------------|:---------|:---------|:----------|:---------|
| Arizona     | 646 ± 31 | 927 ± 32 | 1995 ± 46 | 722 ± 43 |
| Oxford      | 750 ± 30 | 940 ± 30 | 1980 ± 35 | 755 ± 30 |
| Zurich      | 676 ± 24 | 941 ± 23 | 1940 ± 30 | 685 ± 34 |
Tableau 1 : Âges radiocarbones ($1\sigma$) obtenus dans le cadre de l'étude du Suaire de Turin (Damon *et al.*, 1989).

Avant de calibrer les âges radiocarbones obtenus, plusieurs questions peuvent être explorées : les résultats des différents laboratoires sont-ils homogènes ?

$$ \bar{x}  = \frac{\sum_{i=1}^{n}{w_i x_i}}{\sum_{i=1}^{n}{w_i}}$$

$$ \sigma = \left(\sum_{i=1}^{n}{w_i}\right)^{-1/2} $$

Avec $w_i = \frac{1}{s_i^2}$.

$$ T = \sum_{i=1}^{n}{\left( \frac{x_i - \bar{x}}{s_i} \right)^2} $$
$T$ suit une loi du $\chi^2$ avec $n-1$ degrés de liberté.

```{r turin}
## Importer les données
turin <- read.table("data/damon1989.csv", sep = ",", dec = ".", 
                    header = TRUE, row.names = 1)

## Construire une matrice pour stocker les résultats
cbn <- matrix(nrow = 4, ncol = 3)
rownames(cbn) <- paste0("E", 1:4)
colnames(cbn) <- c("age", "erreur", "statistique")

i <- 1
for (j in seq(from = 1, to = ncol(turin), by = 2)) {
  # Pour chaque échantillon...
  age <- turin[[j]] # Extraire les âges
  inc <- turin[[j + 1]] # Extraire les incertitudes
  
  # Calculer la moyenne pondérée
  moy <- stats::weighted.mean(x = age, w = 1 / inc^2)
  # Calculer l'erreur associée à la moyenne pondérée
  err <- sum(1 / inc^2)^(-1/2)
  # Calculer la statistique du test
  chi <- sum(((age - moy) / inc)^2)
  
  cbn[i, ] <- c(moy, err, chi) # Stocker les résultats
  i <- i + 1
}
cbn

qchisq(p = 0.05, df = 2)

```

## Bibliographie

Anderson, E. C., W. F. Libby, S. Weinhouse, A. F. Reid, A. D. Kirshenbaum, et A. V. Grosse. 1947. "Radiocarbon From Cosmic Radiation". *Science* 105 (2735): 576‑77. https://doi.org/10.1126/science.105.2735.576.

Arnold, J. R., et W. F. Libby. 1949. "Age Determinations by Radiocarbon Content: Checks with Samples of Known Age". *Science* 110 (2869): 678‑80. https://doi.org/10.1126/science.110.2869.678.

Colman, S. M., K. L. Pierce, et P. W. Birkeland. 1987. "Suggested Terminology for Quaternary Dating Methods." *Quaternary Research* 28 (2): 314-19. https://doi.org/10.1016/0033-5894(87)90070-6.

Damon, P. E., D. J. Donahue, B. H. Gore, A. L. Hatheway, A. J. T. Jull, T. W. Linick, P. J. Sercel, et al. 1989. "Radiocarbon dating of the Shroud of Turin". *Nature* 337 (6208): 611‑15. https://doi.org/10.1038/337611a0.

Dean, J. S. "Independent Dating in Archaeological Analysis". In *Advances in Archaeological Method and Theory*, 223‑55. Elsevier, 1978. https://doi.org/10.1016/B978-0-12-003101-6.50013-5

Libby, W. F. "Radiocarbon Dating". *Nobel Lecture*. Stockholm, 12 décembre 1960. http://www.nobelprize.org/nobel_prizes/chemistry/laureates/1960/libby-lecture.html.

O'Brien, M. J, et R. L. Lyman *Seriation, Stratigraphy, and Index Fossils: The Backbone of Archaeological Dating*. Dordrecht : Springer, 2002, p. 8-9

Reimer, P. J., M. G. L. Baillie, E. Bard, A. Bayliss, J. W. Beck, P. G. Blackwell, C. Bronk Ramsey, *et al.* 2009. "IntCal09 and Marine09 Radiocarbon Age Calibration Curves, 0–50,000 Years Cal BP". *Radiocarbon* 51 (4): 1111‑50. https://doi.org/10.1017/S0033822200034202. 

Reimer, P. J., E. Bard, A. Bayliss, J. W. Beck, P. G. Blackwell, C. Bronk Ramsey, C. E. Buck, *et al.* 2013. "IntCal13 and Marine13 Radiocarbon Age Calibration Curves 0-50,000 Years cal BP". *Radiocarbon* 55 (4): 1869‑87. https://doi.org/10.2458/azu_js_rc.55.16947.

Reimer, P. J., W. E. N. Austin, E. Bard, A. Bayliss, P. G. Blackwell, C. Bronk Ramsey, M. Butzin, et al. 2020. "The IntCal20 Northern Hemisphere Radiocarbon Age Calibration Curve (0-55 Cal KBP)". *Radiocarbon*, 1‑33. https://doi.org/10.1017/RDC.2020.41.

Scott, E. M., G. T Cook, et P. Naysmith. 2007. "Error and Uncertainty in Radiocarbon Measurements". *Radiocarbon* 49 (2): 427‑40. https://doi.org/10.1017/S0033822200042351.

Ward, G. K., et S. R. Wilson. 1978. "Procedures for Comparing and Combining Radiocarbon Age Determinations: A Critique". *Archaeometry* 20 (1): 19‑31. https://doi.org/10.1111/j.1475-4754.1978.tb00208.x.

## Notes

[^1]: Par opposition à une datation *relative* qui ordonne une séquence d'événements. À proprement parler, il n'existe pas de méthode de datation absolue car toutes s'inscrivent dans un référentiel particulier. Certains auteurs préfèrent ainsi parler de datation *quantifiable* (O'Brien et Lyman, 2002). Néanmoins, par commodité, on conserve ici cette terminologie, étant entendu qu'une date absolue est exprimée comme un point sur une échelle standard de mesure du temps (Dean, 1978).

[^2]: Anderson *et al.* 1947.

[^3]: Arnold et Libby, 1949. Libby, 1960.

[^4]: Il existe actuellement trois séries de courbes de calibration : *IntCal* pour l'hémisphère nord, *SHCal* pour l'hémisphère sud et *Marine* pour les échantillons marins.

[^5]: Au moment de la rédaction de cette leçon, la courbe IntCal20 vient d'être publiée. Reimer *et al.*, 2009, 2013, 2020.

[^6]: L'année 1950 est utilisée comme référence, car elle correspondait lors des premiers développements du radiocarbone à l'époque astronomique standard. Aujourd'hui, le choix de 1950 permet également d'avoir une référence qui précède suffisamment les conséquences des essais nucléaires atmosphériques.

[^7]: Scott, Cook et Naysmith, 2007.

[^8]: Colman, Pierce et Birkeland, 1987.

[^9]: Dans les faits, la calibration par simple interception n'a plus lieu d'être utilisée.

[^10]: Fractionnement isotopique.
